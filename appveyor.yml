image: Visual Studio 2019

version: VS2019.wine.appveyor.{build}
skip_branch_with_pr: true
clone_depth: 1
clone_folder: C:\reactos-unused

init:
#    # 'C:\Program Files\Git\usr\bin\perl.exe'.
#   - where perl
#    # '/usr/bin/perl'.
#   - which perl
#    # 'This is perl 5, version 26, subversion 2 (v5.26.2) built for x86_64-msys-thread-multi'.
#   - perl -v
  - md C:\wine-project
  - git clone --depth 1 git://source.winehq.org/git/wine.git C:\wine-project\wine

build_script:
  - cd C:\wine-project\wine
  - move /Y C:\reactos-unused\wine\* tools\winapi\
# Comment utiliser widl pour generer les 2 .h manquants ?
# Et pourquoi utilise-t-il les .h de Wine au lieu de ceux du MS SDK ?
#   - dir include
# BadSyntax  - del dlls\*\tests\generated.c
#   - perl ./tools/winapi/winapi_test --help
  - perl ./tools/winapi/winapi_test
#   - perl ./tools/winapi/winapi_test --verbose
   # Vraiment trop (10 MiB, first 1min30s is truncated)
#   - perl ./tools/winapi/winapi_test -d
   # 10 'C:\wine-project\wine\dlls\*\tests'
#   - dir /s "*generated.c*"

test: off
# Comment compiler (seulement) les generated.c? (Pour v√©rifier que corrects.)

before_test:
  - 7z a -mx generated-c.7z  dlls\*\tests\generated.c
#   -FileName ros_tests-%SGVER%.7z
  - appveyor PushArtifact generated-c.7z

test_script:
  - echo NoOp. Only to enable "test_script", thus "before_test".

deploy: off
